
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Budgeting Monthly Tracker</title>
  <style>
    /* Minimal CSS inline to avoid any external issues */
    body{
      margin:0; min-height:100vh; display:grid; grid-template-rows:1fr auto;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; color:#fff;
      background:
        linear-gradient(180deg, rgba(8,17,28,0.80), rgba(8,17,28,0.85)),
        url('https://images.unsplash.com/photo-1543512218-d4d483b70f37?auto=format&fit=crop&w=1800&q=80')
        center/cover fixed no-repeat;
    }
    .wrap{ max-width:1040px; width:100%; margin:0 auto; padding:48px 16px; display:flex; justify-content:center; align-items:center; }
    .card{ width:100%; background:rgba(255,255,255,0.08); backdrop-filter:blur(12px); border:1px solid rgba(255,255,255,0.18); border-radius:20px; box-shadow:0 10px 30px rgba(0,0,0,0.35); padding:24px; }
    h1{ text-align:center; margin:0 0 8px 0; font-weight:700; }
    .subtitle{ text-align:center; color:#cbd5e1; margin:0 0 18px 0; }
    .topbar{ display:flex; gap:12px; align-items:center; justify-content:space-between; flex-wrap:wrap; margin-bottom:14px; }
    .pill{ display:flex; gap:10px; align-items:center; padding:8px 12px; border-radius:999px; border:1px solid rgba(255,255,255,0.18); background:rgba(255,255,255,0.08); }
    .grid{ display:grid; grid-template-columns:1fr 1fr 1fr; gap:18px; }
    @media (max-width:900px){ .grid{ grid-template-columns:1fr; } }
    .row{ margin-bottom:12px; }
    label{ display:block; margin-bottom:6px; }
    .input£{ position:relative; }
    .input£ span{ position:absolute; left:10px; top:50%; transform:translateY(-50%); color:#93c5fd; font-weight:600; }
    .input£ input, .textinput, .numinput, select{
      width:100%; padding:14px 12px 14px 38px; border-radius:12px; border:1px solid rgba(255,255,255,0.18);
      background:rgba(255,255,255,0.10); color:#fff; outline:none;
    }
    .numsmall{ width:110px; padding:8px; border-radius:10px; border:1px solid rgba(255,255,255,0.22); background:rgba(255,255,255,0.10); color:#fff; }
    .actions{ display:flex; gap:10px; flex-wrap:wrap; justify-content:center; margin-top:16px; }
    .btn{ padding:12px 14px; border-radius:12px; border:none; background:#0ea5e9; color:#082032; font-weight:600; cursor:pointer; }
    .btn.secondary{ background:rgba(255,255,255,0.16); color:#fff; border:1px solid rgba(255,255,255,0.22); }
    .btn.ghost{ background:transparent; border:1px dashed rgba(255,255,255,0.30); color:#fff; }
    .inline-results{ margin-top:12px; text-align:center; color:#e5e7eb; }
    .viz{ margin-top:18px; }
    #pieCanvas{ background:rgba(255,255,255,0.06); border:1px solid rgba(255,255,255,0.18); border-radius:12px; }
    .fab{ position:fixed; bottom:22px; right:22px; padding:12px 14px; border-radius:999px; border:none; background:#0ea5e9; color:#082032; font-weight:600; cursor:pointer; box-shadow:0 10px 30px rgba(0,0,0,0.35); }
    .panel{ position:fixed; bottom:90px; right:22px; max-width:420px; background:rgba(255,255,255,0.10); backdrop-filter:blur(12px); border:1px solid rgba(255,255,255,0.20); border-radius:16px; padding:16px; display:none; }
    .panel-line{ display:flex; justify-content:space-between; margin:6px 0; }
    footer{ text-align:center; padding:14px; color:#cbd5e1; font-size:13px; }
    footer a{ color:#93c5fd; text-decoration:none; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>Budgeting Monthly Tracker</h1>
      <p class="subtitle">A minimal, experimentative budgeting tool for living in London.</p>

      <div class="topbar">
        <div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap;">
          <label class="pill">
            <span>Month</span>
            <input id="monthInput" type="month" onchange="calculate()" />
          </label>
          <span style="color:#cbd5e1;font-size:12px;">Pick the month you're budgeting for</span>
        </div>
        <div style="display:flex;gap:10px;flex-wrap:wrap;">
          <button class="btn secondary" onclick="resetAll()">Reset</button>
          <button class="btn" onclick="exportCSV()">Export CSV</button>
        </div>
      </div>

      <div class="grid">
        <!-- Core Bills (shared) -->
        <div>
          <h3>Core Monthly Bills</h3>
          <div class="row"><label>Rent</label><div class="input£"><span>£</span><input id="rent" type="number" step="0.01" min="0" inputmode="decimal" placeholder="0.00" oninput="calculate()"></div></div>
          <div class="row"><label>Council Tax</label><div class="input£"><span>£</span><input id="council" type="number" step="0.01" min="0" inputmode="decimal" placeholder="0.00" oninput="calculate()"></div></div>
          <div class="row"><label>Electricity</label><div class="input£"><span>£</span><input id="electricity" type="number" step="0.01" min="0" inputmode="decimal" placeholder="0.00" oninput="calculate()"></div></div>
          <div class="row"><label>Gas</label><div class="input£"><span>£</span><input id="gas" type="number" step="0.01" min="0" inputmode="decimal" placeholder="0.00" oninput="calculate()"></div></div>
          <div class="row"><label>Water</label><div class="input£"><span>£</span><input id="water" type="number" step="0.01" min="0" inputmode="decimal" placeholder="0.00" oninput="calculate()"></div></div>
          <div class="row"><label>Wi‑Fi / Broadband</label><div class="input£"><span>£</span><input id="wifi" type="number" step="0.01" min="0" inputmode="decimal" placeholder="0.00" oninput="calculate()"></div></div>
          <div class="row"><label>Phone Bill</label><div class="input£"><span>£</span><input id="phone" type="number" step="0.01" min="0" inputmode="decimal" placeholder="0.00" oninput="calculate()"></div></div>
        </div>

        <!-- Subscriptions (shared) -->
        <div>
          <h3>Subscriptions</h3>
          <div style="display:flex;align-items:center;gap:10px;margin-bottom:10px;">
            <label><input type="checkbox" id="subNetflix" onchange="calculate()"> Netflix</label>
            <input id="subNetflixAmt" class="numsmall" type="number" step="0.01" min="0" value="10.99" oninput="calculate()">
          </div>
          <div style="display:flex;align-items:center;gap:10px;margin-bottom:10px;">
            <label><input type="checkbox" id="subDisney" onchange="calculate()"> Disney+</label>
            <input id="subDisneyAmt" class="numsmall" type="number" step="0.01" min="0" value="7.99" oninput="calculate()">
          </div>
          <div style="display:flex;align-items:center;gap:10px;margin-bottom:10px;">
            <label><input type="checkbox" id="subPrime" onchange="calculate()"> Amazon Prime</label>
            <input id="subPrimeAmt" class="numsmall" type="number" step="0.01" min="0" value="8.99" oninput="calculate()">
          </div>
          <div style="display:flex;align-items:center;gap:10px;margin-bottom:10px;">
            <label><input type="checkbox" id="subSpotify" onchange="calculate()"> Spotify</label>
            <input id="subSpotifyAmt" class="numsmall" type="number" step="0.01" min="0" value="11.99" oninput="calculate()">
          </div>

          <div style="display:flex;gap:10px;align-items:center;margin-top:12px;">
            <select id="subSelect" onchange="/* noop */" class="textinput" style="padding:10px; border-radius:10px; border:1px solid rgba(255,255,255,0.22); background:rgba(255,255,255,0.10);">
              <option value="">Choose a subscription to add…</option>
              <option value="Apple TV+|8.99">Apple TV+ (£8.99)</option>
              <option value="YouTube Premium|12.99">YouTube Premium (£12.99)</option>
              <option value="Google One / iCloud|1.99">Google One / iCloud (£1.99)</option>
              <option value="Gym|25.00">Gym (£25.00)</option>
            </select>
            <button class="btn ghost" onclick="addCustomSub()">+ Add</button>
          </div>
          <div id="subsCustom" style="display:flex;flex-direction:column;gap:10px;margin-top:10px;"></div>
        </div>

        <!-- Couple Household & Income -->
        <div>
          <h3>Couple Household & Income</h3>
          <div style="display:flex;align-items:center;gap:10px;margin-bottom:10px;">
            <label>Household Supplies</label>
            <input id="hhSuppliesAmt" class="numinput" type="number" step="0.01" min="0" value="0" oninput="calculate()">
          </div>
          <div style="display:flex;align-items:center;gap:10px;margin-bottom:10px;">
            <label>Contents Insurance</label>
            <input id="hhInsuranceAmt" class="numinput" type="number" step="0.01" min="0" value="0" oninput="calculate()">
          </div>
          <div style="display:flex;align-items:center;gap:10px;margin-bottom:10px;">
            <label>Groceries</label>
