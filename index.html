
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>UK Student Cost of Living Tracker</title>

  <!-- Inter font -->
  <link rel="preconnect"com
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&

  <!-- External CSS (ensures styles always load) -->
  style.css

  <!-- (Optional) Relax CSP for fonts/images on some setups -->
  <meta http-equiv="Content-Security-Policy"
        content="default-src 'self';
                 style-src 'self' https://fonts.googleapis.com 'unsafe-inline';
                 font-src https://fonts.gstatic.com;
                 img-src 'self' https://images.unsplash.com data:;
                 script-src 'self' 'unsafe-inline';
                 connect-src 'self';">
</head>
<body>
  <div class="center">
    <div class="wrap">
      <h1 class="title">UK Student Cost of Living</h1>
      <p class="subtitle">A minimal, experimentative budgeting tool for living in London.</p>

      <div class="card">
        <!-- Top bar -->
        <div class="topbar">
          <div class="left">
            <label class="pill">
              <span>Month</span>
              <input id="monthInput" type="month" />
            </label>
            <span class="muted">Pick the month you're budgeting for</span>
          </div>
          <div class="actions">
            <button class="btn secondary" id="resetBtn">Reset</button>
            <button class="btn" id="exportBtn">Export CSV</button>
          </div>
        </div>

        <!-- Grid -->
        <div class="grid">
          <!-- Base expenses -->
          <div>
            <div class="row">
              <label>Rent</label>
              <div class="field"><span class="prefix">£</span>
                <input id="rent" class="input" type="number" placeholder="0.00" min="0" step="0.01">
              </div>
            </div>
            <div class="row">
              <label>Council Tax</label>
              <div class="field"><span class="prefix">£</span>
                <input id="council" class="input" type="number" placeholder="0.00" min="0" step="0.01">
              </div>
            </div>
            <div class="row">
              <label>Wi‑Fi / Broadband</label>
              <div class="field"><span class="prefix">£</span>
                <input id="wifi" class="input" type="number" placeholder="0.00" min="0" step="0.01">
              </div>
            </div>
            <div class="row">
              <label>Phone Bill</label>
              <div class="field"><span class="prefix">£</span>
                <input id="phone" class="input" type="number" placeholder="0.00" min="0" step="0.01">
              </div>
            </div>
            <div class="row">
              <label>Credit Card Repayments</label>
              <div class="field"><span class="prefix">£</span>
                <input id="credit" class="input" type="number" placeholder="0.00" min="0" step="0.01">
              </div>
            </div>
            <div class="row">
              <label>Groceries</label>
              <div class="field"><span class="prefix">£</span>
                <input id="groceries" class="input" type="number" placeholder="0.00" min="0" step="0.01">
              </div>
            </div>
          </div>

          <!-- Partner & extras -->
          <div>
            <div class="row">
              <label>Partner Split</label>
              <div class="radio-row">
                <label class="radio"><input id="partnerToggle" type="checkbox"> Add partner split</label>
                <label class="pill"><input type="radio" name="splitType" id="splitEqual" value="equal" checked> Equal</label>
                <label class="pill"><input type="radio" name="splitType" id="splitPercent" value="percent"> Percentage</label>
              </div>
              <div id="percentRow" class="muted" style="display:none; margin-top:8px;">
                <div class="pct-row">
                  <span>Your share %</span>
                  <input id="youPct" type="number" min="0" max="100" step="1" value="50" class="pct-input">
                  <span>Partner % = <span id="partnerPctText">50</span></span>
                </div>
              </div>
            </div>

            <div class="row">
              <label>Extra Expenses</label>
              <div id="extras" class="extras"></div>
              <div class="actions">
                <button class="btn ghost" id="addExtraBtn">+ Add extra</button>
              </div>
              <div class="muted">Add custom lines (e.g., travel, books, societies, gym).</div>
            </div>
          </div>
        </div>

        <!-- Bottom actions -->
        <div class="actions center-actions">
          <button class="btn" id="calcBtn">Calculate</button>
          <button class="btn secondary" id="togglePanelBtn">View Results</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Floating Results -->
  <button class="btn floating-toggle" id="fabBtn">Results</button>
  <div class="floating-panel" id="panel">
    <div class="panel-title">Results <span id="monthLabel" class="muted"></span></div>
    <div class="panel-line"><span>Monthly total</span><strong id="monthlyTotal">£0.00</strong></div>
    <div class="panel-line"><span>Yearly total</span><strong id="yearlyTotal">£0.00</strong></div>
    <div id="partnerBreak" style="display:none; margin-top:8px;">
      <div class="panel-line"><span>Your share</span><strong id="yourShare">£0.00</strong></div>
      <div class="panel-line"><span>Partner share</span><strong id="partnerShare">£0.00</strong></div>
      <div class="muted">Split: <span id="splitDesc">Equal</span></div>
    </div>
  </div>

  <!-- Footer credit -->
  <footer>
    Created by <strong>Shounak Bhattacharjee</strong> •
    <a href="httpskedin.com/in/shounakbhattacharjee31LinkedIn</a>
  </footer>

  <script>
    // ---------- Utilities ----------
    const gbp = n => "£" + (Number(n||0)).toFixed(2);
    const val = id => parseFloat(document.getElementById(id).value) || 0;

    // ---------- Extras dynamic ----------
    const extrasEl = document.getElementById('extras');
    const addExtraBtn = document.getElementById('addExtraBtn');

    function addExtraRow(label='', amount=''){
      const row = document.createElement('div');
      row.className = 'extra-row';
      row.innerHTML = `
        <input class="input" type="text" placeholder="Label (e.g., Travel)" value="${label}">
        <div class="field">
          <span class="prefix">£</span>
          <input class="input" type="number" placeholder="0.00" min="0" step="0.01" value="${amount}">
        </div>
      `;
      extrasEl.appendChild(row);
      attachLiveUpdate();
    }
    // Add 3 blank boxes initially
    addExtraRow(); addExtraRow(); addExtraRow();

    addExtraBtn.addEventListener('click', e => { e.preventDefault(); addExtraRow(); });

    // ---------- Partner split ----------
    const partnerToggle = document.getElementById('partnerToggle');
    const splitEqual = document.getElementById('splitEqual');
    const splitPercent = document.getElementById('splitPercent');
    const percentRow = document.getElementById('percentRow');
    const youPctInput = document.getElementById('youPct');
    const partnerPctText = document.getElementById('partnerPctText');

    function updatePercent(){
      let youPct = parseFloat(youPctInput.value || 0);
      youPct = Math.max(0, Math.min(100, youPct));
      youPctInput.value = youPct;
      partnerPctText.textContent = (100 - youPct).toFixed(0);
    }
    youPctInput.addEventListener('input', updatePercent);
    splitPercent.addEventListener('change', () => percentRow.style.display = 'block');
    splitEqual.addEventListener('change', () => percentRow.style.display = 'none');
    updatePercent();

    // ---------- Floating panel ----------
    const panel = document.getElementById('panel');
    document.getElementById('fabBtn').addEventListener('click', () => panel.classList.toggle('visible'));
    document.getElementById('togglePanelBtn').addEventListener('click', () => panel.classList.toggle('visible'));

    // ---------- Reset & Export ----------
    document.getElementById('resetBtn').addEventListener('click', () => {
      ['rent','council','wifi','phone','credit','groceries'].forEach(id => document.getElementById(id).value = '');
      document.getElementById('monthInput').value = '';
      partnerToggle.checked = false; splitEqual.checked = true; splitPercent.checked = false; percentRow.style.display = 'none';
      youPctInput.value = 50; updatePercent();
      extrasEl.innerHTML = ''; addExtraRow(); addExtraRow(); addExtraRow();
      calculate(); // refresh totals
    });

    document.getElementById('exportBtn').addEventListener('click', () => {
      const month = document.getElementById('monthInput').value || 'Unspecified';
      const base = [
        ['Rent', val('rent')],
        ['Council Tax', val('council')],
        ['Wi‑Fi', val('wifi')],
        ['Phone Bill', val('phone')],
        ['Credit Card', val('credit')],
        ['Groceries', val('groceries')],
      ];
      const extras = Array.from(extrasEl.children).map(row=>{
        const [labelInput, amountWrap] = row.children;
        const amountInput = amountWrap.querySelector('input[type="number"]');
        const label = labelInput.value || 'Extra';
        const amount = parseFloat(amountInput.value||0);
        return [label, amount];
      });

      const monthlyTotal = sumAll(base) + sumAll(extras);
      const yearlyTotal = monthlyTotal * 12;

      let youShare = '', partnerShare = '', splitMeta = '';
      if (partnerToggle.checked){
        if (splitPercent.checked){
          const youPct = parseFloat(youPctInput.value||0);
          youShare = monthlyTotal * (youPct/100);
          partnerShare = monthlyTotal - youShare;
          splitMeta = `Percentage (${youPct}% / ${ (100-youPct).toFixed(0) }%)`;
        } else {
          youShare = monthlyTotal/2;
          partnerShare = monthlyTotal/2;
          splitMeta = 'Equal (50% / 50%)';
        }
      }

      let rows = [
        ['Month', month],
        ...base,
        ...extras,
        ['Monthly Total', monthlyTotal.toFixed(2)],
        ['Yearly Total', yearlyTotal.toFixed(2)],
      ];
      if (partnerToggle.checked){
        rows.push(['Split Type', splitMeta]);
        rows.push(['Your Share (Monthly)', (youShare||0).toFixed(2)]);
        rows.push(['Partner Share (Monthly)', (partnerShare||0).toFixed(2)]);
      }

      const csv = 'data:text/csv;charset=utf-8,' + 
        'Category,Amount (£)\n' + rows.map(r => r.join(',')).join('\n');
      const a = document.createElement('a');
      a.href = encodeURI(csv);
      a.download = `cost_of_living_${month.replace(/-/g,'_')||'unspecified'}.csv`;
      document.body.appendChild(a); a.click(); a.remove();
    });

    // ---------- Calculation ----------
    const monthlyTotalEl = document.getElementById('monthlyTotal');
    const yearlyTotalEl  = document.getElementById('yearlyTotal');
    const monthLabelEl   = document.getElementById('monthLabel');
    const yourShareEl    = document.getElementById('yourShare');
    const partnerShareEl = document.getElementById('partnerShare');
    const partnerBreakEl = document.getElementById('partnerBreak');
    const splitDescEl    = document.getElementById('splitDesc');

    function sumAll(list){ return list.reduce((s, [_, n]) => s + Number(n||0), 0); }

    function gatherExtras(){
      return Array.from(extrasEl.children).map(row=>{
        const [labelInput, amountWrap] = row.children;
        const amountInput = amountWrap.querySelector('input[type="number"]');
        return [labelInput.value || 'Extra', parseFloat(amountInput.value||0)];
      });
    }

    function calculate(){
      const base = [
        ['Rent', val('rent')],
        ['Council Tax', val('council')],
        ['Wi‑Fi', val('wifi')],
        ['Phone Bill', val('phone')],
        ['Credit Card', val('credit')],
        ['Groceries', val('groceries')],
      ];
      const extras = gatherExtras();

      const month = document.getElementById('monthInput').value || '';
      monthLabelEl.textContent = month ? `• ${month}` : '';

      const monthlyTotal = sumAll(base) + sumAll(extras);
      const yearlyTotal = monthlyTotal * 12;
      monthlyTotalEl.textContent = gbp(monthlyTotal);
      yearlyTotalEl.textContent  = gbp(yearlyTotal);

      // Partner section
      if (partnerToggle.checked){
        partnerBreakEl.style.display = 'block';
        if (splitPercent.checked){
          const youPct = parseFloat(youPctInput.value||0);
          const yourShare = monthlyTotal * (youPct/100);
          const partnerShare = monthlyTotal - yourShare;
          yourShareEl.textContent = gbp(yourShare);
          partnerShareEl.textContent = gbp(partnerShare);
          splitDescEl.textContent = `Percentage (${youPct}% / ${(100-youPct).toFixed(0)}%)`;
        } else {
          const share = monthlyTotal / 2;
          yourShareEl.textContent = gbp(share);
          partnerShareEl.textContent = gbp(share);
          splitDescEl.textContent = 'Equal (50% / 50%)';
        }
      } else {
        partnerBreakEl.style.display = 'none';
      }
    }

    document.getElementById('calcBtn').addEventListener('click', calculate);

    function attachLiveUpdate(){
      const inputs = document.querySelectorAll('.input, #monthInput, #youPct, #partnerToggle, #splitEqual, #splitPercent');
      inputs.forEach(el => el.addEventListener('input', calculate));
      partnerToggle.addEventListener('change', calculate);
      splitEqual.addEventListener('change', calculate);
      splitPercent.addEventListener('change', calculate);
    }
    attachLiveUpdate();
    calculate(); // initial render
  </script>
</body>
</html>
